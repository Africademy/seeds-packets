<script type="text/babel">
  class ExampleTable extends React.Component {
    constructor(props) {
      super(props);
      // Grab the first token and determine available token types
      const firstToken = props.tokens[0];
      const types = {
        app: firstToken.app,
        sass: firstToken.sass,
        javascript: firstToken.javascript,
        swift: firstToken.swift,
        android: firstToken.android,
        python: firstToken.python
      };
      const availableTypes = Object.keys(types).filter(type => types[type]);

      this.state = {
        availableTypes,
        selectedType: availableTypes[0]
      };
    }

    displayName = type => {
      const displayNames = {
        app: 'Design App',
        sass: 'Sass',
        javascript: 'JavaScript',
        swift: 'Swift',
        android: 'Android',
        python: 'Python'
      };

      return displayNames[type];
    };

    changeTokenType = e => {
      this.setState({
        selectedType: e.target.value
      });
    }

    render() {
      const {tokens, rowStyle, ChildClass} = this.props;
      const {availableTypes, selectedType} = this.state;

      return (
        <table>
          <thead>
            <tr>
              <th scope="col">
                Name
                <select value={selectedType} onChange={this.changeTokenType}>
                  {availableTypes.map(type => <option value={type}>{this.displayName(type)}</option>)}
                </select>
              </th>

              <th scope="col"></th>                  

              <th scope="col">
                Value
              </th>

              <th scope="col">Example</th>
            </tr>
          </thead>

          <tbody>
            {tokens.map(token => (
              <tr key={token.app} style={rowStyle}>
                <th scope="row">
                  <pre>{token[selectedType]}</pre>
                </th>

                <td>
                  {token.deprecated && (
                    <span class="Tag Tag--deprecated Tag--inverse">Deprecated</span>
                  )}
                </td>

                <td>
                  <pre>{token.value}</pre>
                </td>

                <td>
                  <ChildClass token={token} />
                </td>
              </tr>
            ))}
          </tbody>
        </table>
      )
    }
  }
</script>
